% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/export_genbank.R
\name{create_annotated_genbank}
\alias{create_annotated_genbank}
\title{Create Annotated GenBank File with Mutations}
\usage{
create_annotated_genbank(
  reference_file,
  mutation_data,
  output_file,
  sheets = c("Mutations", "Missing"),
  color_by = c("stage", "type"),
  target_seq_id = NULL
)
}
\arguments{
\item{reference_file}{Path to reference file (.dna or .gbk)}

\item{mutation_data}{Data frame with mutations (from compare_named_tables) or path to Excel file}

\item{output_file}{Path for output GenBank file}

\item{sheets}{Sheet names to process (default: c("Mutations", "Missing"))}

\item{color_by}{How to color features: "stage" (evolution round) or "type" (mutation type)}

\item{target_seq_id}{Optional: only include mutations from this seq_id.
If NULL, auto-detected from reference file (first/largest replicon).}
}
\value{
Path to the created GenBank file
}
\description{
Takes a reference sequence (GenBank or SnapGene .dna) and adds mutation
annotations from breseq comparison results. For multi-replicon genomes,
only mutations on the reference sequence (typically chromosome) are included;
plasmid mutations are ignored.
}
\examples{
\dontrun{
# From data frame
create_annotated_genbank(
  reference_file = "reference.dna",
  mutation_data = comparison_results,
  output_file = "annotated.gbk"
)

# From Excel file - only chromosome mutations
create_annotated_genbank(
  reference_file = "chromosome.dna",
  mutation_data = "mutations.xlsx",
  output_file = "annotated.gbk"
)
}
}
